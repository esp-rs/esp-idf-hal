<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="@brief      Send a packet over the mesh network - Send a packet to any device in the mesh network. - Send a packet to external IP network."><title>esp_mesh_send in esp_idf_sys - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-46132b98.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="esp_idf_sys" data-themes="" data-resource-suffix="" data-rustdoc-version="1.86.0-nightly (8361aef0d 2025-01-14)" data-channel="nightly" data-search-js="search-75f5ac3e.js" data-settings-js="settings-0f613d39.js" ><script src="../static.files/storage-59e33391.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../esp_idf_sys/index.html">esp_<wbr>idf_<wbr>sys</a><span class="version">0.36.1</span></h2></div><div class="sidebar-elems"><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="index.html">esp_idf_sys</a></span><h1>Function <span class="fn">esp_mesh_send</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/esp_idf_sys/home/runner/work/esp-idf-hal/esp-idf-hal/target/riscv32imc-esp-espidf/debug/build/esp-idf-sys-7bacc267eb742aef/out/bindings.rs.html#27685-27691">Source</a> </span></div><pre class="rust item-decl"><code>pub unsafe extern &quot;C&quot; fn esp_mesh_send(
    to: *const <a class="union" href="union.mesh_addr_t.html" title="union esp_idf_sys::mesh_addr_t">mesh_addr_t</a>,
    data: *const <a class="struct" href="struct.mesh_data_t.html" title="struct esp_idf_sys::mesh_data_t">mesh_data_t</a>,
    flag: c_int,
    opt: *const <a class="struct" href="struct.mesh_opt_t.html" title="struct esp_idf_sys::mesh_opt_t">mesh_opt_t</a>,
    opt_count: c_int,
) -&gt; <a class="type" href="type.esp_err_t.html" title="type esp_idf_sys::esp_err_t">esp_err_t</a></code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>@brief      Send a packet over the mesh network
- Send a packet to any device in the mesh network.
- Send a packet to external IP network.</p>
<p>@attention  This API is not reentrant.</p>
<p>@param[in]  to  the address of the final destination of the packet
- If the packet is to the root, set this parameter to NULL.
- If the packet is to an external IP network, set this parameter to the IPv4:PORT combination.
This packet will be delivered to the root firstly, then users need to call esp_mesh_recv_toDS() on the root node to forward this
packet to the final IP server address.
@param[in]  data  pointer to a sending mesh packet
- Field size should not exceed MESH_MPS. Note that the size of one mesh packet should not exceed MESH_MTU.
- Field proto should be set to data protocol in use (default is MESH_PROTO_BIN for binary).
- Field tos should be set to transmission tos (type of service) in use (default is MESH_TOS_P2P for point-to-point reliable).
- If the packet is to the root, MESH_TOS_P2P must be set to ensure reliable transmission.
- As long as the MESH_TOS_P2P is set, the API is blocking, even if the flag is set with MESH_DATA_NONBLOCK.
- As long as the MESH_TOS_DEF is set, the API is non-blocking.
@param[in]  flag  bitmap for data sent
- Flag is at least one of the three MESH_DATA_P2P/MESH_DATA_FROMDS/MESH_DATA_TODS, which represents the direction of packet sending.
-  Speed up the route search
- If the packet is to an internal device, MESH_DATA_P2P should be set.
- If the packet is to the root (“to” parameter isn’t NULL) or to external IP network, MESH_DATA_TODS should be set.
- If the packet is from the root to an internal device, MESH_DATA_FROMDS should be set.
- Specify whether this API is blocking or non-blocking, blocking by default.
- In the situation of the root change, MESH_DATA_DROP identifies this packet can be dropped by the new root
for upstream data to external IP network, we try our best to avoid data loss caused by the root change, but
there is a risk that the new root is running out of memory because most of memory is occupied by the pending data which
isn’t read out in time by esp_mesh_recv_toDS().</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code>          Generally, we suggest esp_mesh_recv_toDS() is called after a connection with IP network is created. Thus data outgoing
          to external IP network via socket is just from reading esp_mesh_recv_toDS() which avoids unnecessary memory copy.</code></pre></div>
<p>@param[in]  opt  options
- In case of sending a packet to a certain group, MESH_OPT_SEND_GROUP is a good choice.
In this option, the value field should be set to the target receiver addresses in this group.
- Root sends a packet to an internal device, this packet is from external IP network in case the receiver device responds
this packet, MESH_OPT_RECV_DS_ADDR is required to attach the target DS address.
@param[in]  opt_count  option count
- Currently, this API only takes one option, so opt_count is only supported to be 1.</p>
<p>@return</p>
<ul>
<li>ESP_OK</li>
<li>ESP_FAIL</li>
<li>ESP_ERR_MESH_ARGUMENT</li>
<li>ESP_ERR_MESH_NOT_START</li>
<li>ESP_ERR_MESH_DISCONNECTED</li>
<li>ESP_ERR_MESH_OPT_UNKNOWN</li>
<li>ESP_ERR_MESH_EXCEED_MTU</li>
<li>ESP_ERR_MESH_NO_MEMORY</li>
<li>ESP_ERR_MESH_TIMEOUT</li>
<li>ESP_ERR_MESH_QUEUE_FULL</li>
<li>ESP_ERR_MESH_NO_ROUTE_FOUND</li>
<li>ESP_ERR_MESH_DISCARD</li>
</ul>
</div></details></section></div></main></body></html>